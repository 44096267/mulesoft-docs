= To Export Data to External Analytics Tools (Hybrid)
keywords: analytics, monitoring, splunk, elk, elastisearch, logstash, kibana, logs, mule events, logging, apy analytics, metrics, traceability, arm, anypoint runtime manager

This topic describes the prerequisites for sending data from Anypoint Platform to external data analytics tools. It also provides a general discussion of the architecture.

This topic describes how to configure Runtime Manager to export data to external analytics tools. This enables you to send the event notifications of your Mule Applications to 3rd part tool such as Splunk and ELK.

This functionality is only available in hybrid deployment scenarios. It is not available for applications deployed to CloudHub.

== Basic Architecture

The Runtime Manager exists as:

* a component of the link:/getting-started/index[Anypoint Platform]
* a component of the Anypoint Platform Private Cloud Edition that you can install on-premises

Anypoint Platform Private Cloud Edition has a Runtime Manager that handles only applications that are deployed on-premises. The cloud-based version of Anypoint Platform has a Runtime Manager that allows you manage applications deployed to link:/runtime-manager/index[CloudHub] as well as applications that are deployed on-premises and to your own cloud servers. When using whichever version of the Runtime Manager, there's always a way to monitor your applications. Applications deployed to CloudHub can use link:/runtime-manager/insight[Insight]: MuleSoft’s Analytics & Monitoring feature. Applications that you deploy on-premises or to your own cloud servers can be integrated into third-party analytics applications, which is what this document describes.

////
Applications deployed on Cloud can either use Insights (MuleSoft’s Analytics & Monitoring feature) or be integrated into third party analytics applications for a unified view of monitoring and analytics. Apps deployed on on-prem must be integrated into third party analytics applications.
////

If you deploy apps from Runtime Manager to customer-managed Mule servers, you can send your Mule app event and analytics data to third party analytics software such as *Elk* and *Splunk*.

[NOTE]
Sending data to third party software is not currently available for applications on link:/runtime-manager/cloudhub[CloudHub]. See link:/runtime-manager/deployment-strategies[Deployment Strategies] for more details.

Integration between Runtime Manager and third-party analytics software looks like this:

image:amc_onprem_diagram_detail.jpg[image]

The link:/runtime-manager/runtime-manager-agent[Runtime Manager Agent] acts in between Runtime Manager and the third party software. The agent enables integration and sends event notifications to your third party analytics tool.

== Prerequisites

Please make sure you have one of the following runtimes installed:

* Mule ESB – Version 3.6 or above
* API Gateway Standalone – Version 2.1.0 or above  (optional in case you want to deal with apps that are built with the API Gateway Runtime)

[NOTE]
Runtime Manager Agent 1.2.0 or above is required, the steps to install and configure it are provided below.

== Installation and Setup of Runtime Manager with a third party analytics tool

In order to have Runtime Manager send data to an external analytics tool, you must follow these steps, which are explained in detail further down.

image:steps-for-external-logs.png[steps]


=== Update the Runtime Manager Agent


First you must install the latest version of the Runtime Manager Agent, which is in charge of sending messages out of mule. In order to send event information to third party software, you need to have version *1.2.0* or newer of the Runtime Manager Agent.
See link:/runtime-manager/installing-and-configuring-mule-agent[installing and configuring Runtime Manager Agent].

[NOTE]
====
Although the Runtime Manager Agent exists by default bundled with the Mule runtime download as of version 3.7, all Mule Runtime versions older than version 3.7.2 contain an old version of the Runtime Manager Agent that doesn't support this feature. If this is your case, you must download the latest version of the Runtime Manager Agent separately.

*Download it http://mule-agent.s3.amazonaws.com/1.2.0/mule-agent-1.2.0.zip[here]*
====

=== Register the Runtime Manager Agent

Place the agent file in your `MULE HOME}/bin` folder, and then you must register it to the Runtime Manager by running a command in the terminal. Depending on wether you wish to use Runtime Manager through the cloud platform or as part of the Anypoint Platform Private Cloud Edition, you must pass this command a different set of arguments to register it. To obtain the basic command that you must run (complete with your Runtime Manager instance ID) you must do the following:

To obtain this code, you must do the following:

. Sign in to your Anypoint Platform account
+
[TIP]
To open Anypoint Platform Private Cloud Edition, make sure you've already initiated Runtime Manager. If you haven't then you must boot it by running docker. Once initiated, you can access it by navigating to https://localhost in a browser.

. Navigate to `Runtime Manager - > Servers`
. Click `Add Server`. Without needing to actually add a new server, a sample command will be displayed in a popup window that includes the code for your particular organization. Copy this command, depending on where you wish to deploy, you may need to add extra arguments to it.

+
image:org_code.png[image]


[tabs]
------
[tab,title="Anypoint Platform Cloud"]
....

When using Runtime Manager as part of the cloud-based Anypoint Platform, launch the agent with exactly the same command that you found on the Runtime Manager UI:

[source, linenums]
----
amc_setup -H 1c3eded9-7917-4a5e-bbe0-f73f9d4f33c1---2 myServer
----

or on Windows:

[source, linenums]
----
amc_setup.bat -H 1c3eded9-7917-4a5e-bbe0-f73f9d4f33c1---2 myServer
----

The argument `-H` is an id that references your organization in the Anypoint platform Private Cloud Edition installation.

The final argument of this command is the name that you assign for your Runtime Manager Agent instance, in the above example, `myServer`. This name will then be visible when interacting with the agent from your Runtime Manager console.

....
[tab,title="Anypoint Platform Private Cloud Edition"]
....

When using Anypoint Platform as an application running on-premises, launch the agent with the following arguments:

[source, linenums]
----
amc_setup -A http://localhost:8080/hybrid/api/v1 -W wss://localhost:8443/mule -C https://dev.anypoint.mulesoft.com/accounts -H 361755d7-c619-42ce-9187-19db7a6d94a0---2 myServer
----

or on Windows:

[source, linenums]
----
amc_setup.bat -A http://localhost:8080/hybrid/api/v1 -W wss://localhost:8443/mule -C https://dev.anypoint.mulesoft.com/accounts -H 361755d7-c619-42ce-9187-19db7a6d94a0---2 myServer
----

The argument `-H` is an id that references your organization in Anypoint Platform installation.

The final argument of this command is the name that you assign for your Runtime Manager Agent instance, in the above example, `myServer`. This name will then be visible when interacting with the agent from your Runtime Manager console.

Note that three extra arguments must be added to what you copied from the Runtime Manager UI: -A, -W and -C.
* *A* sets the Runtime Manager host address
* *C* sets the Core Services host address
* *W* sets the Mule Communications Manager (MCM) host address

....
------
=== Update the Runtime Manager Agent

If you update the Agent version, it isn't necessary to undeploy the running apps.


[TIP]
For more information on how to install or Update the Runtime Manager Agent, see link:/runtime-manager/installing-and-configuring-mule-agent[installing and configuring Runtime Manager Agent]


image:agent_server.jpg[image]

[NOTE]
Creating multiple agents within a single server is not supported.

==== Verifying Agent Registration

After running the above command, open Runtime Manager to verify that the agent has been registered successfully:

. Sign in to Anypoint Platform with your credentials
. Go to `Runtime Manager - > Servers`. You should now see that one of those servers is your Agent instance, named with the name you provided when installing it:

image:verify_agent.jpg[image]

=== Configure Mule Custom Events

You can configure the Runtime Manager to send out Mule Events to external software, this includes flow executions, exceptions raised, etc. This works with apps deployed to any runtime, and for both the Runtime Manager in the cloud and the Runtime Manager that comes bundled with the link:/anypoint-private-cloud/v/1.5/[Anypoint Platform Private Cloud Edition].



== Encrypting Passwords


== See Also

* link:/runtime-manager/managing-servers[Managing Servers]
* link:/runtime-manager/monitoring[Monitoring Applications]
* Learn how to first link:/runtime-manager/deploying-to-your-own-servers[Deploy Applications to your Own Servers]
* link:/runtime-manager/managing-deployed-applications[Managing Deployed Applications] contains more information on how to manage your application once deployed
* link:/runtime-manager/managing-applications-on-your-own-servers[Managing Applications on Your Own Servers] contains more information specific to on-premise deployments
* A link:/runtime-manager/runtime-manager-api[REST APIs] is also available for deployment to your servers.
