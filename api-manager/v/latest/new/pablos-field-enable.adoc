make sure api is running

apply a policy

apply to all api methods & resources

choose to which methods and resources,

preview of regex
on right side (have to be in goodle), check regex  go to policies dashboard check policies

resource matching -- what the mapping is

got to postman, look at headers, you have rate limiting policies on version you applied only to get, not to underlying resources

only set up implementation URL of api that is running

wait til policies picked up by gateway -- postaman shows all policies on this requet, but if you do a specific resource no -- just applied policies to get

^/product

screenshot 3

CH app app running, set up proxy on local mule runtime. consumer calling the proxy which forwards it to a mule app,  proxy app, autogenerated by api manager, has autodiscovery configured in it--if you download you see, when app deployed mule rt looks at all apps that have autodis element and mule rt initiates call to api mgr with bus group client id and secret and to gets all policies for all api versions specified in the autodiscovery element

get all policies applied to each app and locks api to receive calls..

--------

screenshot 4
Now have basic endpoint, same scenario, but not want to manage api implement directly from CH, need api autodiscovery name - version, configure api in apimamage that has this basic endpoint and mule endpoing will connect to that 

manage api from exchange, basic endpoing save. got back to administration, have version 1 and 2 instance, one for proxy that's running and one for basic endpoint to manage directly. save, go back to administration, now you have 2 instances when would u want to do this.  one for proxy and one for basic image you want throttlinbis you want caching policies in proxy, ... but actual polsicies for security in the implementation directly, -- in basic, unregistered bec api implementation published  in CH does not have autodiscover element in it. (screenshot 6) we need to add to api implementation for runtime to connect and act on policies. 

in pre-crowd rt was going to bus group client secret to api mgmt to get policies. it worked because api mgm had unique names at bus group level. now with environments, same api can have multiple environment. Instead of having the business group, mule needs envir client id and secret. mule rt asks to

(screenshot 5) to get 

policies for that api in right environment. you can have multip instances in same environment. in dev environ you can have an instance for basic endpoint, now you have to specify in autodis which instance to get policies for, in autodiscovery element you set that up:

name="groupID:{{groupID}}:assetId:{{assetId}}"
version="{{version}}:{{instanceId}}"

open studio
mule 3.9
create autodisc, use format to set up autodiscover same as ppt
go to get all infor to copy past into Studio autodis in Settings (screenshot 7.0) in QA now

in Studio Autodiscovery -- (screenshot 8)
group id (also in url): assetid:
api Version 1.0 Basic

Deploy to CH from studio

in Runtime Mgr

In Properties , configure environment client id and seceret (get from access manager) -- only needed fo CH, in RT use Environment properties for CH (don't need for local RT)

(copy from asset mgmt)

other properties not needed in Properties in RT mgr

TRICK

Go to RT mgr and look at proxy deployed, all configured, now you can get all details on configuration in Settings in RT mgr

you can download the app, you can see the proxy 

if you download the proxy -- unzip it

(screenshot 9) -- autodiscovery

screenshoot 11 -- the two autodiscovery values config.properties in META-INFO/src/main/resources

you can apply policy to basic endpoint. you have to have autodiscovery component, in api manager, deploy basic endpoing

sometimes you have a url but want to show a different url to consumer., mabye you don't want to use cloudhub, you can configure url--add consumer endpoint, http://product.mydomain.com

go to api in exchange, already has enpoints that were selected and the URL is the one you configured for consumer endpoing url -- integrated with Exchange

configure consumer-facing endpoints: integrated in Exchange

API promotion:

promote everything from dev to staging. go into staging, promote from 

source -- development
api --

when u promote api, you promote the configuration of it, is some tings are differen t , uncheck. the endpoint implementation URL will change when you promote it.

deploy

go to api mgr, promote the implementation.

go to Runtime Manager staging, 


Other things

two apis:
one to manage
another to deploy

permissions per environment and function this user has permission in production to view analytics and bla bla but not delete an api

all or nothing all apis -- see  all apis you're assigned to or nothing

screenshot12 classified

when you migrate all apis in unclassified environment.

Upgrade-- gateways were using bus group. in crowd envirnoment. no impact of updgrade on runtime during upgrade process, when a client connects with the client id and secret of bus group, we we go and find api in unclassified environment there, leave apis in unclassified then try to find it

if using the client id of environment, then we try to find in an environ, if not look in unclassified.

after finishing migration, similar ui to api mgmt today (screenshot 13), click on a version, see old ui, same operation as before

after you classify into environment, you see new UI.

feature comparison (screenshot 14)

classification

rt needs to have client id and secret to classify

prepare for classification shows instructions if i configure client id and secreet, the

need to restart









