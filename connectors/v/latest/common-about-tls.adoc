= About TLS

Transport Layer Security (TLS) alleviates the problem of securing data in an application network. Some connectors provide a secure, server-side connection over a protocol, such as HTTPS or SMTPS (Simple Mail Transfer Protocol Secure). These connectors require configuration of TLS. Design Center supports TLS 1.1/1.2. You can set up a connector to use one or both of the following TLS configurations:

* A trust store
* A key store in JKS format 

You can configure TLS on the server-side using the connector UI, such as HTTP Listener, or a Mule XML editor. Some connectors also provide a secure client-side connection. In the HTTP Request configuration, for example, you can explicitly configure TLS in the request. If you don't configure TLS in the request, the app uses default JVM certificates to establish communications.

In XML, you configure the tls:context child element of the listener-config. 

**QUESTION FOR REVIEWERS: WHAT DO WE NEED TO SAY IN DESIGN CENTER CONNECTOR DOCS ABOUT TLS CONFIGURATION IN MULE?**

== Configuring a Key Store

You configure two passwords for the key store: 

* One to access the entire key store file
* Another (keyPassword) to access the private key of the server inside the key store file

In Design Center, set the path field to the location of the key store file that contains the private and public keys of the client. Alternatively, in the XML Editor, add the <tls:key-store> element.

**QUESTION FOR REVIEWERS: IN 3.8 PER THE KEY STORE CERTIFICATE WAS OPTIONAL, BUT IN DESIGN CENTER, IT SEEMS REQUIRED. SHOULD THIS BE MENTIONED IN THE MIGRATION GUIDE?**

== Configuring a Trust Store

Certificates can be generated by a well-known Certificate Authority (CA) or you can generate a certificate locally without external approval (self-signed certificate). A certificates generated from Certificate Authorities includes a digital signature that is usually accepted as trusted by any client that includes the CA certificate in its trust store. 

If you donâ€™t provide any values for the trust-store, the default Java trust store is used. The default trust store is updated with the Java version. Consequently, use an updated Java version that includes updates to well known CA certificates.

In the UI, you set the path to the location of the trust store file that contains the certificates of the trusted servers. Alternatively, in the XML Editor, add the <tls:trust-store> element. 

== Configuring Two-Way Authentication

A TLS service needs to have two-way authentication: a private key and a public certificate. As mentioned, to configure two-way authentication, set up both a key store and a trust store. Configure the key store on the server to enforce two-way authentication with the client. The private key never leaves the server. The public certificate is exposed through TLS so clients can verify that they trust the server.

== Configuring TLS Protocols and Cipher Suites

You can fine-tune the TLS configuration by manually setting which cipher suites and protocols to use. In the UI, the HTTP Listener Configuration and HTTP Request Configuration includes fields for configuring these things.

image::tls-protocols-cipher-suites.png[TLS Listener Configuration Enabled Protocols Enabled Cipher Suites,height=452,width=460]

For example, in Enabled Protocols, enter *TLSv1.2,SSLv3*. In Enabled Ciper Suites, enter the following value:

----
ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256
----

If you do not use a UI, you can configure protocols and cipher suites in the Mule `/conf` directory. Select one of two files for fine-tuning the configuration of SSL connectors by manually setting which cipher suites and protocols Mule will use:

* tls-default.conf 
+
Allows fine-tuning when Mule is not configured to run in Federal Information Processing Standards (FIPS) security mode.
+
* tls-fips140-2.conf
+
Allows fine-tuning when Mule is running in FIPS security mode.

== See Also

* link:/connectors/common-workflow-conf-tls[Workflow: Configuring TLS]




