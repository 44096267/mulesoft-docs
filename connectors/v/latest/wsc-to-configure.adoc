= To Configure the Web Service Consumer
:keywords: web service consumer, configure
:toc:
:toc-title: Page Contents

toc::[]

In Flow Designer, you can create an API from a WSDL that is on your 
computer or at a URL. 

*Sample WSDL: link:_attachments/sunsetriseservice.wsdl[sunsetriseservice.wsdl]*

. In Design Center, click *+* to add a component to a flow.
. Click *Web Service Consumer*.
. In Web Services Consumer, click *Set up*.
. In Web Service Consumer Configuration, specify a WSDL location. For example, on a Mac OSX computer: +
`file:///Users/YOURUSERNAME/FOLDERNAME/WSDLFILENAME.wsdl`
+
Or in Windows:
`file:///DRIVELETTER/FOLDERNAME/WSDLFILENAME.wsdl`
+
For example, `file:///Users/me/Downloads/sunsetriseservice.wsdl`
+
. Specify the service, such as `SOAP`.
. Specify the port, such as 8082.
+
For information on non-required fields see link:/connectors/web-service-consumer-documentation#parameters-2[Configuration Parameters].
+
. Click *Test* to test the connection to your WSDL file.
. Click *Save* to exit.
. In the connector properties page, specify *Operation* as the `Consume` value.
+
Flow Designer automatically runs your project. If successful, a green circle appears 
in the taskbar and *Update* is active.

You can test the sample WSDL in the next section.

== To Test SunSetRiseService

The web service for this example is the link:http://www.webservicex.net/ws/WSDetails.aspx?CATID=12&WSID=65[SunSetRise Web service]. For information on constructing
a SOAP HTML message, see link:https://www.w3schools.com/xml/xml_soap.asp[W3CSchools XML SOAP]. 

The request and response are both represented by an XML document that specifies:

* Your location in latitude and longitude. Note that you need use negative latitude values for the Southern Hemisphere and negative longitude values for the Eastern Hemisphere. Coordinates are in decimal rather than degrees, minutes and seconds.
* A target date for providing sunrise and sunset times.
* The time zone of the final results (offset from GMT).

Here is a sample request message of GetSunSetRiseTime in SOAP 1.1 to get sunrise and sunset times:

[source, xml, linenums]
----
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope"
 xmlns:web="http://www.webserviceX.NET/">
 <soap:Header/>
 <soap:Body>
  <web:GetSunSetRiseTime>
   <web:L>
      <web:Latitude>0.0</web:Latitude>
      <web:Longitude>0.0</web:Longitude>
      <web:TimeZone>0</web:TimeZone>
      <web:Day>21</web:Day>
      <web:Month>3</web:Month>
      <web:Year>2015</web:Year>
   </web:L>
  </web:GetSunSetRiseTime>
 </soap:Body>
</soap:Envelope>
----

The SunSetTime and SunRiseTime elements are omitted because those are computed by the service. The response includes the populated elements.

Here is a sample response:

[source, xml, linenums]
----
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope
  xmlns:soap="http://www.w3.org/2003/05/soap-envelope"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <soap:Body>
    <GetSunSetRiseTimeResponse
      xmlns="http://www.webserviceX.NET/">
      <GetSunSetRiseTimeResult>
          <Latitude>0</Latitude>
          <Longitude>0</Longitude>
          <SunSetTime>17.9877033</SunSetTime>
          <SunRiseTime>5.87441826</SunRiseTime>
          <TimeZone>0</TimeZone>
          <Day>21</Day>
          <Month>3</Month>
          <Year>2015</Year>
      </GetSunSetRiseTimeResult>
    </GetSunSetRiseTimeResponse>
  </soap:Body>
</soap:Envelope>
----

Note that SunSetTime and SunRiseTime are in decimal rather than hours, minutes, and seconds.


== About Taking a Project into Anypoint Studio 7

After developing your project in Flow Designer, if you want to move your project to 
Studio, this section provides the necessary POM file modifications to enable use of 
the Web Service Consumer in Studio 7.

The configuration for the web service consumer is basically a container for the connection. It only has one optional attribute: the *encoding*. The provided encoding in use in all requests and responses is managed by the link:/connectors/wsc-to-consume[Consume] operation. If no encoding is specified, the web service consumer uses Mule's default encoding.

Before adding the Web Service Consumer connector to your Studio 7 project, add the following to your 
project's `pom.xml` file:

[source,xml,linenums]
----
<dependency>
  <groupId>org.mule.modules</groupId>
  <artifactId>mule-module-wsc</artifactId>
  <version>${project.version}</version>
  <classifier>mule-plugin</classifier>
  <scope>provided</scope>
</dependency>
----

Configuration topics:

* link:/connectors/wsc-to-configure-security[To Configure Security]
* link:/connectors/wsc-to-create-connection[To Create a Connection]

[source,xml,linenums]
----
<wsc:config name="config"  encoding="UTF-8">
     <wsc:connection … />
</wsc:config>
----

== XML Example

The following XML example shows the use of the Web Service Consumer connector, DataWeave for echoing text, and an
HTTP Listener:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:httpn="http://www.mulesoft.org/schema/mule/httpn"
      xmlns:wsc="http://www.mulesoft.org/schema/mule/wsc"
      xmlns="http://www.mulesoft.org/schema/mule/core" 
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core 
      http://www.mulesoft.org/schema/mule/core/current/mule.xsd
          http://www.mulesoft.org/schema/mule/wsc 
          http://www.mulesoft.org/schema/mule/wsc/current/mule-wsc.xsd
http://www.mulesoft.org/schema/mule/httpn 
http://www.mulesoft.org/schema/mule/httpn/current/mule-httpn.xsd">

    <wsc:config name="config">
        <wsc:connection wsdlLocation="http://localhost:${servicePort}/server?wsdl" 
             service="TestService" port="TestPort" soapVersion="${soapVersion}">
            <reconnect blocking="false"/>
        </wsc:connection>
    </wsc:config>
    
    <httpn:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config" >
		<httpn:listener-connection host="0.0.0.0" port="8081" />
	</httpn:listener-config>
	<flow name="echoWithHeadersOperation">
        <httpn:listener config-ref="HTTP_Listener_config" path="/" doc:name="Listener" />
		<wsc:consume config-ref="config" operation="echoWithHeaders">
            <wsc:message>
                <wsc:body>
                #[
                %dw 1.0
                %output application/xml
                %namespace con http://service.ws.extension.mule.org/
                ---
                con#echoWithHeaders: {
                   text: "test"
                }]
                </wsc:body>
                <wsc:headers>
                #[
                %dw 1.0
                %output application/xml
                %namespace con http://service.ws.extension.mule.org/
                ---
                "headers": {
                    con#headerIn: "Header In Value",
                    con#headerInOut: "Header In Out Value"
                }]
                </wsc:headers>
            </wsc:message>
        </wsc:consume>
    </flow>
</mule>
----


== See Also

* link:/connectors/web-service-consumer[Web Service Consumer Connector]
* link:/connectors/wsc-to-consume[To Consume from the Connector]
