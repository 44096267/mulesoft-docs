= To Design a RAML API Specification

link:/getting-started/api-lifecycle-overview#which-version[_Requires Crowd Release_]


This procedure covers how to design an API that consumes the free online REST service JSONPlaceholder. For example purposes, the API is oversimplified. The API just lists the comments about a particular post to the service. You put the ID of a post in the last component of the URL that starts the API.


. In Anypoint Platform, click Design Center. Set up a project to create a new API specification:
+
* In Projects, click Create. Select API Specification.
+
* In New API Specification, type a name for your new project. For example, type jsonplaceholder. Click Create.
+
Visual API Designer opens.
+
. In API Info, set options as follows:
+
* In Title, type the title of the API. For example, *placeholder*.
* In Version, type a version of the API. For example, *'0.1'*.
* In Protocols, select HTTP or HTTPS. Select HTTP for this example.
* In Media Type, select a media type. For example, select application/json.
* Optionally, in Base URI, type the base URI. For example, type the following URI:
+
`+http://jsonplaceholder.typicode.com/posts/{num}+`
+
. Click Base URI Parameters, and then + to define the num parameter. Set options for the base URI parameter Num:
+
* In Name, type an arbitrary name for the base URI parameter. For example, name the parameter *Num*. 
* In Type, select a RAML scalar type. For example, select Integer.
* In Description, type an description of the URI parameter. For example, type *The number of stored comments in posts.*
* Define additional RAML facets for Integer to restrict the inputs allowed for the parameter:
** Accept the default Required setting = checked.
** In Minimum and Maximum, enter input range limits. For example, type *1* and *5*, respectively. To call the API, you need to provide a number between 1-5.
** In Format, select a value. For example, select int.
** In Example number, enter *3*.
** In Default Number, enter *1*.
** In Description, type a description of API using markdown. For example, type *This API gets the comments about a post given a variable integer post **id** at the end of the URL.*
+
The generated RAML code appears on the right. 
+
----
#%RAML 1.0
title: placeholder
description: This API gets the comments about a post given a variable integer post **id** at the end of the URL.
version: 0.1
baseUri: http://jsonplaceholder.typicode.com/posts/{num}
baseUriParameters:
  num: 
    format: int
    type: integer
    minimum: 1
    maximum: 10
    example: 3
    description: The number of stored comments in posts
    default: 1
----
+
. Click + and select New Resource.
+
image::vd-newresource.png[]
+
/newResource appears in the navigation pane and a code stub for the resource appears in the RAML code:
----
/newResource:
  displayName: /newResource
----
+
. In the canvas, set options for defining the resource:
+
* Rename the resource to */comments*.
* Select one or more methods. For this example, select GET.
* Click Responses, and then click Add Response +.
* In Status, accept the default 200-OK.
* In Description, describe the status. For example, type *Success, comments retrieved.*
* Click Bodies (0) +
* Accept the default application/json as the mime type for the example response.
* In Type, select Array.
* In Description, describe the example response. For example, type *A list of comments about a particular post. You specify the **post ID** in the last part of the URI that calls the API.*
* Skip Minimum and Maximum Length, Pattern, and Default. In Example, enter the following JSON array in markdown:
+
----
[
                    {
                      "postId": 1,
                      "id": 1,
                      "name": "id labore ex et quam laborum",
                      "email": "Eliseo@gardner.biz",
                      "body": "laudantium enim quasi est quidem magnam voluptate ipsam eos\ntempora quo necessitatibus\ndolor quam autem quasi\nreiciendis et nam sapiente accusantium"
                    },
                    {
                      "postId": 1,
                      "id": 2,
                      "name": "quo vero reiciendis velit similique earum",
                      "email": "Jayne_Kuhic@sydney.com",
                      "body": "est natus enim nihil est dolore omnis voluptatem numquam\net omnis occaecati quod ullam at\nvoluptatem error expedita pariatur\nnihil sint nostrum voluptatem reiciendis et"
                    }
                  ]
----
* Select the response, and click Code Block to format the markdown.

* Click Documentation, and enter the following description in markdown:
+
*Retrieve a list of posts.*

. Click Edit RAML, and at the end of the generated RAML type the following code for the /comments resource:
+
----
/comments:
  get:
    description: Retrieve a list of posts
    responses:
      200:
        body:
          application/json:
            example: | 
                  [
                    {
                      "postId": 1,
                      "id": 1,
                      "name": "id labore ex et quam laborum",
                      "email": "Eliseo@gardner.biz",
                      "body": "laudantium enim quasi est quidem magnam voluptate ipsam eos\ntempora quo necessitatibus\ndolor quam autem quasi\nreiciendis et nam sapiente accusantium"
                    },
                    {
                      "postId": 1,
                      "id": 2,
                      "name": "quo vero reiciendis velit similique earum",
                      "email": "Jayne_Kuhic@sydney.com",
                      "body": "est natus enim nihil est dolore omnis voluptatem numquam\net omnis occaecati quod ullam at\nvoluptatem error expedita pariatur\nnihil sint nostrum voluptatem reiciendis et"
                    }
                  ]


The project opens for design in the master branch. Two lines of code based on the title and version of the API appear in the RAML editor.
+
. In the RAML editor, go to the next blank line (3).
+
The possible entries you can make appear as options. Click to enter and correctly indent an option into the code.
+
image::designer-shelf.png[baseURI,height=374,width=414]
+
If you don't see these options, click CTRL+space.
+
. At the root level, click Root > baseUri from the list of options. Enter 
`+http://jsonplaceholder.typicode.com+`.
+
. Go to the next line of code, and include a resource in the RAML. Indent the resource at the same level as the `baseUri`.
+
For example, create a `/users` resource:
+
----
...
baseUri: http://jsonplaceholder.typicode.com
/users:
----
+
. Use auto-completion to enter the GET method to retrieve the information defined in `+http://jsonplaceholder.typicode.com+`. 
+
* Put your mouse pointer on the line below /users.
* Indent one level.
* Enter Ctrl+Space.
+
image::design-autocomplete.png[get method,height=409,width=489]
+
* Select get.
. Add a description of the method on the next line. For example:
+
----
/users:
  get:
    description: Retrieve a list of all the users
----
. Include HTTP responses in the RAML for simulating the API:
+
----
responses:
      200:
        body:
----
+
At this point, the API definition looks like this:
+
----
#%RAML 1.0
title: placeholder
baseUri: http://jsonplaceholder.typicode.com
/users:
  get:
    description: Retrieve a list of all the users
    responses:
      200:
        body:
----
+
. Import a JSON example:
+
* Download the `user-example.json` from the "Downloads" section of this document and click Files > Import.
+
image:files-import.png[files import,height=97,width=295]
+
* Choose RAML, and browse to and select the downloaded file. 
* In the RAML editor, type add the following lines to the code:
+
----
...
      application/json:
        example: !include user-example.json
----
. At one indentation from the root, define the following resource:
+
----
  /userbyid:
    get:
      description: Get information about a particular user
      queryParameters:
        id:
          description: Specify the id of the user you want to retrieve
          type:        integer
          required:    false
          example: 3
      responses:
        200:
          body:     
            application/json:
----
+
. Download the RAML code for this task, and add the example for the `/userbyid` resource.

== Downloads

* link:_attachments/placeholder.raml[RAML code for this task]
* link:_attachments/user-example.json[Include file user-example.json]

== See Also

* link:/design-center/v/1.0/simulate-api-task[To Simulate Calling a RAML API]

