= Introduction to Anypoint B2B Portal

[NOTE]
The Anypoint B2B portal is currently in beta. For access, please talk to you account executive.

Anypoint B2B provides an integrated set of components to simplify the configuration and tracking required for implementing typical B2B integrations in the Anypoint platform.

== Architecture

The Anypoint B2B core services are hosted in CloudHub, but can be called from Mule flows running in CloudHub or in Mule ESB. The following diagrams show how these components work together in the context of a CloudHub or Mule ESB (on-premises) application:

=== Anypoint B2B in CloudHub

image:https://docs.google.com/a/modusbox.com/drawings/d/szph4qLZN2b5RAA-I53k7NA/image?w=558&h=497&rev=163&ac=1[image]

== Anypoint B2B in Mule ESB (on-premises)

image:https://docs.google.com/a/modusbox.com/drawings/d/sXC3oZB3y3h-E6NtJmh57cA/image?w=526&h=471&rev=49&ac=1[image]

== Anypoint B2B components

=== B2B Portal

The B2B portal provides a single user interface for viewing and configuring Trading Partner Management settings and B2B Message Tracking data.

=== Trading Partner Management

The Trading Partner Management (TPM) service provides the ability to edit, store and retrieve configuration settings for the transport and format of B2B messages. For example, EDI messages are often sent over the AS2 protocol in order to ensure security and integrity of the transmissions. Each trading partner may have AS2 different settings. In addition different partners may use different format protocols such as EDI X12, EDIFACT, or XML, and different options within those protocols. The TPM system allows this configuration data to be managed outside of your Mule applications, so they can be reviewed without looking at the code and updated without re-deploying your Mule flows.

=== B2B Message Tracking

Because B2B messages often communicate contractual obligations between companies, it is desirable, even necessary in many cases, to track all messages sent or received, storing the actual message content as well as metadata such as data and time the message was sent or received, the identity of the partner, and success or failure of processing. The Anypoint B2B Message Tracking service provides a simple, secure, and integrated mechanism for message tracking within Mulesoft flows. This data can be used for non-repudiation, error correction, and auditing.

Currently the tracking metadata is stored in a database in CloudHub and the actual message content is saved to an S3 bucket provided by the customer.

=== B2B Connector

The B2B Connector coordinates the saving and retrieval of TPM and Tracking data within the Mule Runtime. B2B-enabled connectors communicate with the B2B Connector to request TPM data and to submit tracking data. The B2B Connector handles local caching as well as communication with the TPM and Tracking apis.

=== B2B-enabled Connectors

The AS2, FTPS, X12,and EDIFACT connectors and modules are written to integrate with the Anypoint B2B core services for runtime retrieval of configuration data and for message tracking. The only setup required is to make sure the B2B Connector module is configured with your API Key and to check the “Use B2B Provider” checkbox in the configuration screen of any B2B-enabled connector. Once this is set up, the B2B Connector will ensure that the configuration data for this connector is pulled at runtime from the TPM data and that tracking data will be stored to the Anypoint B2B Message Tracking service.

=== Non-B2B-enabled Connectors

For connectors that are not written to integrate with Anypoint B2B, the B2B Connector that can be used to store data to Message Tracking. The developer can include the B2B Connector in the flow and control what data is sent to the message tracking system.

== Using the B2B Portal

The Anypoint B2B Portal enables all configuration and monitoring for AnyPoint B2B flows.

image:https://lh4.googleusercontent.com/9vnN_Nea_a3C1iWZ5xVamSDmHqyywnj3d6iyjw7cyNfHEAsYEsd1Ye1Z_7iokysqwKVKGul041r2fOlznd6AH5roab4zTHiNqiXHbdTxG3d--beJtBEeptfz-cNM0npUwbImLPI[Screen Shot 2015-07-19 at 10.01.54 PM.png]

=== Trading Partner Management

The following steps are required to configure TTMP settings for a B2B flow using the B2B Portal:

==== In the B2B Portal:

* Set up the home organization
* Set up an external trading partner

==== In AnyPoint Studio

* Build your flow
* Configure the B2B Connector
* Configure B2B-enabled Connectors to use the B2B Connector
* Complete the flow
* Use standard MuleSoft connectors and processors to complete the processing and integration of the message into downstream systems as required.

==== Setting up the home organization

The home organization is you, the company that is subscribing to Anypoint B2B. There is no setup required, but there are a few optional settings:

* Company Name that is displayed in the Portal 
* Contact Information
* AS2 Identity Settings

==== Set up an external trading partner

In order to exchange B2B messages with another company you need to set them up as a Trading Partner in Anypoint B2B. The data you can set up includes Contact information, default settings for various Transport and Format protocols, and details for individual transactions you expect to exchange with the partner.

image:https://lh4.googleusercontent.com/Wn3xsUqVOyVIQveo8ByrwWHMUFZ3g-CwWVw_nvILkchkjqeUOvXmhOWQomm2o5amBhyjqXGiSihGtGsYYDPjkQr_eQPKWDCcwFcbDRsX6xt2G4iGdvaWQbJkOYSZqMDOZ7uWk_8[Screen Shot 2015-07-19 at 10.16.19 PM.png]

===== Contacts

In the contacts section you can configure the name that is displayed for the trading partner, and optionally technical and business contacts for the partner.

===== Transport settings

In the Transport Settings section you can configure the default options for any B2B-enabled transport connectors, currently AS2 and FTP/S.

===== Format Settings

In the Format Settings section you can configure the default options for supported B2B format standards, currently EDI X12 and EDIFACT.

===== Transactions

In the Transactions section you can configure specific transactions you expect to process with this trading partner. Transactions can be inbound or outbound and each is defined by a transport protocol and format protocol. For example, if you expect to receive X12 850 messages and to respond with X12 856 messages, you would set those transactions up as inbound and outbound respectively.

_Note: in Beta 1, it is only required to set up transactions if you are using the FTP/S transport. In future versions of Anypoint B2B there will be options to override the default partner settings in specific transactions, and to control which transactions can be exchanged with a specific trading partner._

=== Monitoring B2B Transmissions

The B2B Portal also supports monitoring the tracking data for B2B Transmissions.

image:https://lh6.googleusercontent.com/4nsa97BmN_EiRu7wXXaHNY_0Py7rEQOMiRT0Iex33eMk9r0neZdQW5Ruq_ue0cSTdgpHAWvorlh9lB1hAVnVFb4AZbD4dS97gVmJtXdLS4i5j4zY4zjRvhcx9xpVHv94lmvbIQE[Screen Shot 2015-07-19 at 10.59.43 PM.png]

The following settings can be used to filter for the specific data you are looking for:

===== Partner

Leave unselected to search all trading partners, or select a specific partner.

===== Type

Select “All” to search all types of B2B messages. Select X12, EDIFACT, AS2, or FTP/S to filter for messages by a specific format or transport. The Type selection also adjusts the fields that are displayed.

Select “All” to search all types of B2B messages. Select X12, EDIFACT, AS2, or FTP/S to filter for messages by a specific format or transport. The Type selection also adjusts the fields that are displayed.

===== Direction

Select the direction to view inbound messages only, outbound messages only, or both.

===== Date

Set the time window for the messages searched. You can quickly set all messages in the past day, week, or month, or set a custom date range.

===== FileName

Search for a specific file or all files that start with the same text.

===== ISA Control #

Search for a message by Control#. (Only enabled when the Type is X12 or EDIFACT.

== Get Started

* https://developer.mulesoft.com/docs/pages/viewpage.action?pageId=133267996[AS2 and EDI X12 Purchase Order Walkthrough]
* https://developer.mulesoft.com/docs/pages/viewpage.action?pageId=133267998[FTPS and EDI X12 Purchase Order Walkthrough]
